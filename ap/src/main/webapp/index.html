
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
     

    <title>Login </title>

    <!-- Bootstrap core CSS -->
    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">
  </head>
 

  <body onload="autoLogin()">

    <div class="container">

      <table class="form-signin">
        <h2 class="form-signin-heading">登入</h2>
        <label class="sr-only">帳號</label>
        <input id="user" class="form-control" placeholder="帳號" required autofocus>
        <label class="sr-only">密碼</label>
        <input type="password" id="pwd" class="form-control" placeholder="密碼" required>
         
        <button class="btn btn-lg btn-primary btn-block" id="btn" >確認</button>
      </table>

    </div> <!-- /container -->


    
  </body>
</html>

<script src="jquery.js" > </script>
<script src="utils.js"> </script>
<script>
	 

	$(document).ready(function(){
		$( "#btn" ).click(function() {
			let user = document.getElementById("user").value;
		    let pwd = document.getElementById("pwd").value;
		    let url = 'http://61.223.38.87:9999/getUid?user='+user+'&pwd='+pwd ; 
	 		
		    
		    $.ajax({ url:url, 
		         async: false,
		         success: function(data) {
		        	 if(data=='null'){
						  alert('帳號過期或密碼錯誤，請聯絡管理員');
						  return;
				 	 }
					 var uid = ( data.split('@')[0] );
					 var mid = ( data.split('@')[1] );
					 //alert("main.html?user="+user+"&pwd="+pwd+"&mid="+mid+"&uid="+encodeURI(uid))
					 window.location.href = "/auto/main1.html?user="+user+"&pwd="+pwd+"&mid="+mid+"&uid="+encodeURI(uid);
	         	 }
	        });
		   
		     
		});

	    
	});
	
	function autoLogin(){
		let query = window.location.search.substring(1);
		let parsed_qs = parse_query_string(query);
		let pwd = (parsed_qs.pwd) ;
		let user= (parsed_qs.user); 
		if(pwd && user){
			let url = 'http://61.223.38.87:9999/getUid?user='+user+'&pwd='+pwd ; 
			
			$.ajax({ url:url, 
		         async: false,
		         success: function(data) {
		        	 let uid = ( data.split('@')[0] );
					 let mid = ( data.split('@')[1] );
					 //alert("main.html?user="+user+"&pwd="+pwd+"&mid="+mid+"&uid="+encodeURI(uid))
					 window.location.href = "/auto/main1.html?user="+user+"&pwd="+pwd+"&mid="+mid+"&uid="+encodeURI(uid);
	         	 }
	        }); 
			 
		}
		
	}
	 

</script>